# ANN Final Project â€“ Predicting Levels of Public Unrest from Social Media Text

This repository contains my final project for **Artificial Neural Networks**, titled:

> **Predicting Levels of Public Unrest from Social Media Text: A Neural Network-Based Solution**

The goal of this project is to train a neural network **from scratch** to estimate the **intensity of public unrest** (in percentage form) expressed in short online text, using the **GoEmotions** dataset as the main training source.

Instead of predicting only discrete labels (calm / mild / high), the model predicts a **continuous unrest score from 0% to 100%**, derived from weighted emotion labels.

---

## ğŸ§  Project Overview

People react to policies, prices, and socio-economic events through social media posts and comments. These reactions can be:

- Calm / accepting  
- Mildly dissatisfied or worried  
- Strongly angry, fearful, or hostile

Manually monitoring all of this text is impossible at scale, so the project focuses on:

- Taking **text input** (Reddit-style comments)
- Converting fine-grained emotion annotations into a **numerical unrest intensity** (0â€“100%)
- Converting text into **high-dimensional numeric features** (TF-IDF)
- Training a **feedforward neural network (MLP)** to predict unrest intensity
- Interpreting the modelâ€™s output as both a **score** and a **probability-like confidence**

The project **does not use any pretrained models** (e.g., BERT, GPT); the neural network is trained from scratch, following course requirements.

---

## ğŸ“ Repository Structure

```text
ANN-FinalProj/
â”‚
â”œâ”€â”€ Goemotion/                # Original GoEmotions package (reference and exploration)
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ analyze_data.py
â”‚   â”œâ”€â”€ calculate_metrics.py
â”‚   â”œâ”€â”€ replace_emotions.py
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ train.tsv
â”‚   â”‚   â”œâ”€â”€ dev.tsv
â”‚   â”‚   â”œâ”€â”€ test.tsv
â”‚   â”‚   â”œâ”€â”€ emotions.txt
â”‚   â”‚   â”œâ”€â”€ ekman_mapping.json
â”‚   â”‚   â””â”€â”€ sentiment_mapping.json
â”‚   â””â”€â”€ plots/, tables/, ...
â”‚
â””â”€â”€ PublicUnrest/             # Actual final project implementation
    â”œâ”€â”€ data/
    â”‚   â”œâ”€â”€ raw/              # Working copy/reference of raw GoEmotions data (tsv/csv)
    â”‚   â””â”€â”€ processed/        # Cleaned & labeled data (generated by preprocessing)
    â”œâ”€â”€ src/                  # Python source code (preprocessing, training, evaluation)
    â”œâ”€â”€ models/               # Saved neural network models, vectorizers, etc.
    â””â”€â”€ documentation/        # Project report, methodology, notes, diagrams


ğŸ§¾ Dataset and Unrest Percentage
GoEmotions

The project uses the GoEmotions dataset (Google Research), which contains ~58k Reddit comments annotated with 27 emotion labels + neutral.

Instead of mapping these directly to 3 classes, we assign each emotion a weight between 0.0 and 1.0 indicating how much it contributes to public unrest.

Example (simplified):

Emotion	Example Weight
admiration	    0.00
approval	    0.00
neutral	        0.00
amusement	    0.00
joy	            0.00
annoyance	    0.40
disappointment	0.45
confusion	    0.45
sadness	        0.50
fear	        0.80
anger	        1.00
disgust	        1.00
disapproval	    1.00
grief	        1.00


For a comment with multiple active emotions, we compute:

Convert each emotion to its weight (0.0â€“1.0)
Compute the mean weight
Convert to percentage:

unrest_percent = mean_weight * 100


Example:
Emotions = {annoyance (0.40), anger (1.00)}
â†’ mean = (0.40 + 1.00) / 2 = 0.70
â†’ unrest_percent = 70%



ğŸ”§ Planned Pipeline

Preprocessing
    Load GoEmotions train.tsv, dev.tsv, test.tsv
    Merge into a single dataset
    Map emotion labels to weighted unrest intensity
    Compute unrest_percent (0â€“100)
    Clean and normalize text
    Split into train/validation/test
    Save processed datasets to PublicUnrest/data/processed/

Feature 
    Use TF-IDF to convert text into numeric vectors
    Limit vocabulary size (e.g., 2,000â€“5,000 features)

Model Training
    Build a feedforward neural network (MLP) for regression
    Example architecture:
        Dense(256, ReLU)
        Dense(64, ReLU)
        Dense(1, Sigmoid) â†’ output in [0, 1], scaled to [0, 100] as percentage
    Train on the training set, validate on validation set

Evaluation
    Evaluate on the held-out test set
    Use regression metrics:
        MAE (Mean Absolute Error)
        MSE (Mean Squared Error)
        RÂ² score
    Optionally interpret the output as a â€œprobability of high unrestâ€ for presentation

Documentation
    Describe the dataset, emotion weighting, bias/privacy considerations, and results in the documentation/ folder.

Implementation and scripts will be located in PublicUnrest/src/.
